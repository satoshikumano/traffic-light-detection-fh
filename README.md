# Traffic light detection on floydhub

Traffic light detection with SSD Mobilenet v1.
Using [Tensorflow Object Detection API](https://github.com/tensorflow/models/tree/master/research/object_detection).

Training datasets and instructions are borrowed from [coldKnigt's repo](https://github.com/coldKnight/TrafficLight_Detection-TensorFlowAPI)

By integrating it with Floydhub, running jobs, preparing dataset and switching environment got easier.

## Prerequisite 

- Create account on [Floydhub](https://www.floydhub.com).
- Buy standard GPU powerups. (10 hour is enough)

- Install cli tools and login to Floydhub.

Refer to official [Quick Start](https://docs.floydhub.com/getstarted/quick_start/#quick-preparation-checklist).


## 1. Run training job

This job uses pre-trained [ssd\_mobilenet\_v1\_coco\_2017\_11\_17](http://download.tensorflow.org/models/object_detection/ssd_mobilenet_v1_coco_2017_11_17.tar.gz) model.

```shell
sh floydrun.sh
```

### Datasets used in training job

- [Training data/ pre-trained model/ config file](https://www.floydhub.com/satoshikumano/datasets/udacity-td-sim)

- [Tensor Flow Model](https://www.floydhub.com/satoshikumano/datasets/tf-models):
 Tensor Flow Object Detection api repo. It includes compiled protos.

### Dataset generated by training job

- [Trained model](https://www.floydhub.com/satoshikumano/datasets/tl-detection-sim-trained)


## 2. Run freezing model job

Export frozen graph.

```shell
sh floydrun-export.sh
```

### Datasets used in freezing job

- [Trained model](https://www.floydhub.com/satoshikumano/datasets/tl-detection-sim-trained)

- [Tensor Flow Model](https://www.floydhub.com/satoshikumano/datasets/tf-models):
 Tensor Flow Object Detection api repo. It includes compiled protos.

### Dataset generated by freezing job

- [Frozen graph](https://www.floydhub.com/satoshikumano/datasets/tl-detection-sim-frozen)


## 3. Check inference on jupyter notebook

Check inference on jupyter notebook

```shell
sh floydrun-notebook.sh
```

### Datasets used in inference

- [Frozen graph](https://www.floydhub.com/satoshikumano/datasets/tl-detection-sim-frozen)

- [Tensor Flow Model](https://www.floydhub.com/satoshikumano/datasets/tf-models):
 Tensor Flow Object Detection api repo. It includes compiled protos.
 
 In the notebook, 'research/object\_detection' directory is symlinked to jupyter notebook workspace
 so that we can use Object Detection Python APIs in the notebook.
